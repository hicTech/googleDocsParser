<!DOCTYPE html> 
<html> 
	<head> 
    <title>GoogleDocsParser</title> 
    <script type="text/javascript" src="jquery-1.4.4.min.js"></script>
    <script type="text/javascript" src="hicGoogleDocsParser.js"></script>
    <script type="text/javascript" src="underscore/underscore.js"></script>
    <script type="text/javascript" src="underscore/_plus.js"></script>
    <style>
      body{
        background-color: black;
        color: green;
        font-size: 13px;
        font-family: sans-serif;
      }
      h1,a{ color: yellow}
      input{
        font-size: 13px;
        background-color: black;
        color:white;
      }
    </style>
  </head> 
  <body> 
   
    <pre id='results'></pre>
    
    
    <div id="result_json"></div>
    


    <script>
    	
    	hicGoogleDocsParser({
    		"url":"https://docs.google.com/spreadsheet/pub?key=0At-edMs8aNDBdGV5U3JfUEFQMnl1Sk42dGNUUVllTlE&output=html",
    		"callback":"printResult"
    	});
     
      
     

    
      
      
      function printResult(result){
      	var data = result.data;
      	var obj = {};
      	var th = {};
      	var tr = [];
      	var trs = [];
      	var result = {"th":null,"trs":null};
      	
      	_.each(data,function(v,index){
      		if(v.indexOf("#label#:") != -1){
      			var label = v.replace("#label#:","");
      			th[index] = label;
      		}
      	});
      	
		
		var new_data = [];       //contains only values without #label#
		_.each(data,function(v){
			if(v.indexOf("#label#") == -1)
				new_data.push(escape(v));
		});
		
		
		var col = 0
		var thisTr = {};
      	_.each(new_data,function(v){	
			thisTr[th[col]] = unescape(v);
			col++;
      		if(col == _.keys(th).length){
      			tr.push(thisTr);
      			thisTr = {};
      			col = 0;
  			}
      	});
      	
      	
      	
      	result.th = th;
      	result.trs = tr;
      	
        alert(_.toStr(result));
      }
    </script>
  </body>
</html>

